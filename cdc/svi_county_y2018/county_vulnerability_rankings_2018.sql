
/*******************************************************
Title: County-Level Social Vulnerability Analysis 2018
 
Business Purpose:
This query analyzes the Social Vulnerability Index (SVI) at the county level
to identify areas that may need additional support during disasters or public
health emergencies. It focuses on the four key themes of social vulnerability:
- Socioeconomic Status
- Household Composition & Disability
- Minority Status & Language
- Housing Type & Transportation

The results help emergency planners and public health officials prioritize 
resources and support for the most vulnerable communities.
*******************************************************/

-- Main analysis of social vulnerability across counties
SELECT
    state,
    county,
    e_totpop as total_population,
    
    -- Overall vulnerability score and ranking
    ROUND(rpl_themes, 3) as overall_vulnerability_percentile,
    
    -- Theme-specific vulnerability scores
    ROUND(rpl_theme1, 3) as socioeconomic_vulnerability,
    ROUND(rpl_theme2, 3) as household_composition_vulnerability, 
    ROUND(rpl_theme3, 3) as minority_language_vulnerability,
    ROUND(rpl_theme4, 3) as housing_transport_vulnerability,
    
    -- Key contributing factors
    ROUND(ep_pov, 1) as poverty_rate,
    ROUND(ep_unemp, 1) as unemployment_rate,
    ROUND(ep_disabl, 1) as disability_rate,
    ROUND(ep_noveh, 1) as no_vehicle_rate,
    ROUND(ep_uninsur, 1) as uninsured_rate

FROM mimi_ws_1.cdc.svi_county_y2018

-- Focus on counties with significant population
WHERE e_totpop >= 1000

-- Order by overall vulnerability, highest first
ORDER BY rpl_themes DESC
LIMIT 100;

/*******************************************************
How it works:
- Extracts key vulnerability metrics for each county
- Filters out very small counties to focus on significant populations
- Ranks counties by overall vulnerability
- Shows both overall and theme-specific vulnerability scores
- Includes key contributing factors for deeper analysis

Assumptions & Limitations:
- Uses 2018 data only - may not reflect current conditions
- County-level aggregation masks within-county variations
- Population threshold of 1000 excludes very small counties
- Percentile rankings are relative to other counties

Possible Extensions:
1. Add geographic grouping to analyze regional patterns:
   - Group by state/region
   - Calculate state averages
   - Compare urban vs rural counties

2. Focus on specific vulnerability factors:
   - Analyze counties with high scores in specific themes
   - Compare contributing factors across regions
   - Identify outliers in specific metrics

3. Add temporal comparison:
   - Compare with previous years' data
   - Track changes in vulnerability over time
   - Identify trending patterns

4. Enhanced filtering and categorization:
   - Filter by population size ranges
   - Categorize by urban/rural classification
   - Group by vulnerability level (high/medium/low)
*******************************************************/
/*

    - Author: claude-3-5-sonnet-20241022
    - Created At: 2024-10-28T16:04:41.909983
    - Additional Notes: Query returns the top 100 most vulnerable counties based on CDC's Social Vulnerability Index. Results include overall vulnerability scores, theme-specific rankings, and key socioeconomic indicators for counties with populations over 1,000. Data is from 2018 ACS estimates and may not reflect current conditions.
    
    */